ngx_addon_name=ngx_devel_kit
HTTP_MODULES="$HTTP_MODULES ngx_http_devel_kit_module"
HTTP_INCS="$HTTP_INCS $ngx_addon_dir/src $NGX_OBJS/addon/ndk"
NGX_ADDON_SRCS="$NGX_ADDON_SRCS $ngx_addon_dir/src/ndk.c"
have=NDK . auto/have

. $ngx_addon_dir/ngx_auto_lib_core

echo "building Nginx Development Kit utility functions and macros ..."

autobuild="$ngx_addon_dir/auto/build"
chmod +x $autobuild
$autobuild `pwd` $NGX_OBJS/addon/ndk || exit 1

echo "applying Nginx Development Kit source patches ..."

patch -Np1 < $ngx_addon_dir/patches/rewrite_functions
patch -Np1 < $ngx_addon_dir/patches/rewrite_phase_handler
